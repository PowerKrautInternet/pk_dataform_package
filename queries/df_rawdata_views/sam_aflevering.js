
/*config*/
let pk = require("../../sources")
let ref = pk.ref
let query = `
SELECT
JSON_VALUE(PAYLOAD, '$.afleveringid') AS AFLEVERINGID,
  JSON_VALUE(PAYLOAD, '$.response.trajectid') AS TRAJECTID,
  JSON_VALUE(PAYLOAD, '$.response.afleveringstatusid') AS AFLEVERINGSTATUSID,
  JSON_VALUE(PAYLOAD, '$.response.goedgekeurddoor') AS GOEDGEKEURDDOOR,
  JSON_VALUE(PAYLOAD, '$.response.goedgekeurddatum') AS GOEDGEKEURDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.orderdatum') AS ORDERDATUM,
  JSON_VALUE(PAYLOAD, '$.response.orderdatumimporteur') AS ORDERDATUMIMPORTEUR,
  JSON_VALUE(PAYLOAD, '$.response.autobinnendatum') AS AUTOBINNENDATUM,
  JSON_VALUE(PAYLOAD, '$.response.afspraakafleverdatumstart') AS AFSPRAAKAFLEVERDATUMSTART,
  JSON_VALUE(PAYLOAD, '$.response.afspraakafleverdatumeind') AS AFSPRAAKAFLEVERDATUMEIND,
  JSON_VALUE(PAYLOAD, '$.response.autoafgeleverddatum') AS AUTOAFGELEVERDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.akdklant') AS AKDKLANT,
  JSON_VALUE(PAYLOAD, '$.response.akdorigineel') AS AKDORIGINEEL,
  JSON_VALUE(PAYLOAD, '$.response.akdhuidig') AS AKDHUIDIG,
  JSON_VALUE(PAYLOAD, '$.response.dealernummer') AS DEALERNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.ordernummer') AS ORDERNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.bestelnummer') AS BESTELNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.chassisnummer') AS CHASSISNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.kenteken') AS KENTEKEN,
  JSON_VALUE(PAYLOAD, '$.response.soortkentekenid') AS SOORTKENTEKENID,
  JSON_VALUE(PAYLOAD, '$.response.soortbrandstofid') AS SOORTBRANDSTOFID,
  JSON_VALUE(PAYLOAD, '$.response.datumdeel1') AS DATUMDEEL1,
  JSON_VALUE(PAYLOAD, '$.response.isvoorraad') AS ISVOORRAAD,
  JSON_VALUE(PAYLOAD, '$.response.bestemming') AS BESTEMMING,
  JSON_VALUE(PAYLOAD, '$.response.statusvoortgang') AS STATUSVOORTGANG,
  JSON_VALUE(PAYLOAD, '$.response.statusflexibiliteit') AS STATUSFLEXIBILITEIT,
  JSON_VALUE(PAYLOAD, '$.response.creatiedatum') AS CREATIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.purgedatum') AS PURGEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.modelscl') AS MODELSCL,
  JSON_VALUE(PAYLOAD, '$.response.versiescl') AS VERSIESCL,
  JSON_VALUE(PAYLOAD, '$.response.extkleurcode') AS EXTKLEURCODE,
  JSON_VALUE(PAYLOAD, '$.response.afkortingkleur') AS AFKORTINGKLEUR,
  JSON_VALUE(PAYLOAD, '$.response.detailkleurcode') AS DETAILKLEURCODE,
  JSON_VALUE(PAYLOAD, '$.response.intkleurcode') AS INTKLEURCODE,
  JSON_VALUE(PAYLOAD, '$.response.aantaloptiesscl1') AS AANTALOPTIESSCL1,
  JSON_VALUE(PAYLOAD, '$.response.optiesscl1') AS OPTIESSCL1,
  JSON_VALUE(PAYLOAD, '$.response.aantaloptiesscl2') AS AANTALOPTIESSCL2,
  JSON_VALUE(PAYLOAD, '$.response.optiesscl2') AS OPTIESSCL2,
  JSON_VALUE(PAYLOAD, '$.response.typeaftersales') AS TYPEAFTERSALES,
  JSON_VALUE(PAYLOAD, '$.response.fabricatienummer') AS FABRICATIENUMMER,
  JSON_VALUE(PAYLOAD, '$.response.sleutelcontact') AS SLEUTELCONTACT,
  JSON_VALUE(PAYLOAD, '$.response.sleutelportier') AS SLEUTELPORTIER,
  JSON_VALUE(PAYLOAD, '$.response.sleutelreservoir') AS SLEUTELRESERVOIR,
  JSON_VALUE(PAYLOAD, '$.response.codeautoradio') AS CODEAUTORADIO,
  JSON_VALUE(PAYLOAD, '$.response.versnellingsbaknummer') AS VERSNELLINGSBAKNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.goedgekeurdsagid') AS GOEDGEKEURDSAGID,
  JSON_VALUE(PAYLOAD, '$.response.motornummer') AS MOTORNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.autobinnensagid') AS AUTOBINNENSAGID,
  JSON_VALUE(PAYLOAD, '$.response.afspraakafleversagid') AS AFSPRAAKAFLEVERSAGID,
  JSON_VALUE(PAYLOAD, '$.response.autoafgeleverdsagid') AS AUTOAFGELEVERDSAGID,
  JSON_VALUE(PAYLOAD, '$.response.autoverkochtsagid') AS AUTOVERKOCHTSAGID,
  JSON_VALUE(PAYLOAD, '$.response.autoverkochtdatum') AS AUTOVERKOCHTDATUM,
  JSON_VALUE(PAYLOAD, '$.response.afspraakleveringactieid') AS AFSPRAAKLEVERINGACTIEID,
  JSON_VALUE(PAYLOAD, '$.response.afleveringmodelid') AS AFLEVERINGMODELID,
  JSON_VALUE(PAYLOAD, '$.response.autoomschrijving') AS AUTOOMSCHRIJVING,
  JSON_VALUE(PAYLOAD, '$.response.automerkid') AS AUTOMERKID,
  JSON_VALUE(PAYLOAD, '$.response.dealerid') AS DEALERID,
  JSON_VALUE(PAYLOAD, '$.response.pkzm') AS PKZM,
  JSON_VALUE(PAYLOAD, '$.response.registratiedatum') AS REGISTRATIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.akdhuidigmelding') AS AKDHUIDIGMELDING,
  JSON_VALUE(PAYLOAD, '$.response.importmutatiedatum') AS IMPORTMUTATIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.nietafleverenvoor') AS NIETAFLEVERENVOOR,
  JSON_VALUE(PAYLOAD, '$.response.inregistratieboek') AS INREGISTRATIEBOEK,
  JSON_VALUE(PAYLOAD, '$.response.reserveringdatumbegin') AS RESERVERINGDATUMBEGIN,
  JSON_VALUE(PAYLOAD, '$.response.reserveringdatumeind') AS RESERVERINGDATUMEIND,
  JSON_VALUE(PAYLOAD, '$.response.reserveringgebruikerid') AS RESERVERINGGEBRUIKERID,
  JSON_VALUE(PAYLOAD, '$.response.extkleuromschrijving') AS EXTKLEUROMSCHRIJVING,
  JSON_VALUE(PAYLOAD, '$.response.intkleuromschrijving') AS INTKLEUROMSCHRIJVING,
  JSON_VALUE(PAYLOAD, '$.response.detailkleuromschrijving') AS DETAILKLEUROMSCHRIJVING,
  JSON_VALUE(PAYLOAD, '$.response.dealernietaanpassen') AS DEALERNIETAANPASSEN,
  JSON_VALUE(PAYLOAD, '$.response.inkoppelscherm') AS INKOPPELSCHERM,
  JSON_VALUE(PAYLOAD, '$.response.isbetaaldklant') AS ISBETAALDKLANT,
  JSON_VALUE(PAYLOAD, '$.response.isbetaaldimporteur') AS ISBETAALDIMPORTEUR,
  JSON_VALUE(PAYLOAD, '$.response.werkplaatsordernummer') AS WERKPLAATSORDERNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.factuurnrklant') AS FACTUURNRKLANT,
  JSON_VALUE(PAYLOAD, '$.response.factuurnrimporteur') AS FACTUURNRIMPORTEUR,
  JSON_VALUE(PAYLOAD, '$.response.inorderresultaten') AS INORDERRESULTATEN,
  JSON_VALUE(PAYLOAD, '$.response.kentekenaangevraagd') AS KENTEKENAANGEVRAAGD,
  JSON_VALUE(PAYLOAD, '$.response.showroomvoorraad') AS SHOWROOMVOORRAAD,
  JSON_VALUE(PAYLOAD, '$.response.occasionid') AS OCCASIONID,
  JSON_VALUE(PAYLOAD, '$.response.overgedragenaan') AS OVERGEDRAGENAAN,
  JSON_VALUE(PAYLOAD, '$.response.overgedragendatum') AS OVERGEDRAGENDATUM,
  JSON_VALUE(PAYLOAD, '$.response.isovergedragen') AS ISOVERGEDRAGEN,
  JSON_VALUE(PAYLOAD, '$.response.wasvoorraad') AS WASVOORRAAD,
  JSON_VALUE(PAYLOAD, '$.response.soortlocatieid') AS SOORTLOCATIEID,
  JSON_VALUE(PAYLOAD, '$.response.voorraadautoid') AS VOORRAADAUTOID,
  JSON_VALUE(PAYLOAD, '$.response.besteldatum') AS BESTELDATUM,
  JSON_VALUE(PAYLOAD, '$.response.rentedatum') AS RENTEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.factuurdatumimporteur') AS FACTUURDATUMIMPORTEUR,
  JSON_VALUE(PAYLOAD, '$.response.uitfabriekdatum') AS UITFABRIEKDATUM,
  JSON_VALUE(PAYLOAD, '$.response.bestelddoor') AS BESTELDDOOR,
  JSON_VALUE(PAYLOAD, '$.response.nettocatprijs') AS NETTOCATPRIJS,
  JSON_VALUE(PAYLOAD, '$.response.autobestELDSAGID') AS AUTOBESTELDSAGID,
  JSON_VALUE(PAYLOAD, '$.response.autobestelddatum') AS AUTOBESTELDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.soortklantcategorieid') AS SOORTKLANTCATEGORIEID,
  JSON_VALUE(PAYLOAD, '$.response.retaildatum') AS RETAILDATUM,
  JSON_VALUE(PAYLOAD, '$.response.registratiegevend') AS REGISTRATIEGEVEND,
  JSON_VALUE(PAYLOAD, '$.response.werkplaatsdatum') AS WERKPLAATSDATUM,
  JSON_VALUE(PAYLOAD, '$.response.autorijklaar') AS AUTORIJKLAAR,
  JSON_VALUE(PAYLOAD, '$.response.regselectiedatum') AS REGSELECTIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.kentekenbinnen') AS KENTEKENBINNEN,
  JSON_VALUE(PAYLOAD, '$.response.autogepoetst') AS AUTOGEPOETST,
  JSON_VALUE(PAYLOAD, '$.response.afleverdealerid') AS AFLEVERDEALERID,
  JSON_VALUE(PAYLOAD, '$.response.registrerenvoor') AS REGISTRERENVOOR,
  JSON_VALUE(PAYLOAD, '$.response.vtrbedrag') AS VTRBEDRAG,
  JSON_VALUE(PAYLOAD, '$.response.werkderden') AS WERKDERDEN,
  JSON_VALUE(PAYLOAD, '$.response.onderdelenbesteld') AS ONDERDELENBESTELD,
  JSON_VALUE(PAYLOAD, '$.response.bestellinggecontroleerd') AS BESTELLINGGECONTROLEERD,
  JSON_VALUE(PAYLOAD, '$.response.bonusopgevoerd') AS BONUSOPGEVOERD,
  JSON_VALUE(PAYLOAD, '$.response.offertenummer') AS OFFERTENUMMER,
  JSON_VALUE(PAYLOAD, '$.response.registratiedatumviardw') AS REGISTRATIEDATUMVIARDW,
  JSON_VALUE(PAYLOAD, '$.response.productiedatum') AS PRODUCTIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.productiestatus') AS PRODUCTIESTATUS,
  JSON_VALUE(PAYLOAD, '$.response.productiestatusmutatiedatum') AS PRODUCTIESTATUSMUTATIEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.fleetcode') AS FLEETCODE,
  JSON_VALUE(PAYLOAD, '$.response.cachedinruilkenteken') AS CACHEDINRUILKENTEKEN,
  JSON_VALUE(PAYLOAD, '$.response.leaseordernummer') AS LEASEORDERNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.onderdelenbinnen') AS ONDERDELENBINNEN,
  JSON_VALUE(PAYLOAD, '$.response.factuurdatumklant') AS FACTUURDATUMKLANT,
  JSON_VALUE(PAYLOAD, '$.response.codestartonderbreking') AS CODESTARTONDERBREKING,
  JSON_VALUE(PAYLOAD, '$.response.luxekentekenplaten') AS LUXEKENTEKENPLATEN,
  JSON_VALUE(PAYLOAD, '$.response.wittekentekenplaten') AS WITTEKENTEKENPLATEN,
  JSON_VALUE(PAYLOAD, '$.response.formulierid') AS FORMULIERID,
  JSON_VALUE(PAYLOAD, '$.response.docbaseid') AS DOCBASEID,
  JSON_VALUE(PAYLOAD, '$.response.calcafleveringstatus') AS CALCAFLEVERINGSTATUS,
  JSON_VALUE(PAYLOAD, '$.response.offerteid') AS OFFERTEID,
  JSON_VALUE(PAYLOAD, '$.response.autotype') AS AUTOTYPE,
  JSON_VALUE(PAYLOAD, '$.response.afgekeurddatum') AS AFGEKEURDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.loyalty_chassisnummer') AS LOYALTY_CHASSISNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.loyalty_kenteken') AS LOYALTY_KENTEKEN,
  JSON_VALUE(PAYLOAD, '$.response.loyalty_active') AS LOYALTY_ACTIVE,
  JSON_VALUE(PAYLOAD, '$.response.externid') AS EXTERNID,
  JSON_VALUE(PAYLOAD, '$.response.hybridelevel') AS HYBRIDELEVEL,
  JSON_VALUE(PAYLOAD, '$.response.co2uitstoot') AS CO2UITSTOOT,
  JSON_VALUE(PAYLOAD, '$.response.recyclingbijdragecons') AS RECYCLINGBIJDRAGECONS,
  JSON_VALUE(PAYLOAD, '$.response.recyclingbijdragebtw') AS RECYCLINGBIJDRAGEBTW,
  JSON_VALUE(PAYLOAD, '$.response.productiedatumverwacht') AS PRODUCTIEDATUMVERWACHT,
  JSON_VALUE(PAYLOAD, '$.response.uitfabriekdatumverwacht') AS UITFABRIEKDATUMVERWACHT,
  JSON_VALUE(PAYLOAD, '$.response.naarimporteurdatum') AS NAARIMPORTEURDATUM,
  JSON_VALUE(PAYLOAD, '$.response.naarimporteurdatumverwacht') AS NAARIMPORTEURDATUMVERWACHT,
  JSON_VALUE(PAYLOAD, '$.response.aankomstimporteurdatum') AS AANKOMSTIMPORTEURDATUM,
  JSON_VALUE(PAYLOAD, '$.response.aankomstimporteurdatumverwacht') AS AANKOMSTIMPORTEURDATUMVERWACHT,
  JSON_VALUE(PAYLOAD, '$.response.naardealerdatum') AS NAARDEALERDATUM,
  JSON_VALUE(PAYLOAD, '$.response.naardealerdatumverwacht') AS NAARDEALERDATUMVERWACHT,
  JSON_VALUE(PAYLOAD, '$.response.kentekenaangevraagddatum') AS KENTEKENAANGEVRAAGDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.transportmedium') AS TRANSPORTMEDIUM,
  JSON_VALUE(PAYLOAD, '$.response.productielocatie') AS PRODUCTIELOCATIE,
  JSON_VALUE(PAYLOAD, '$.response.geschatafleverjaar') AS GESCHATAFLEVERJAAR,
  JSON_VALUE(PAYLOAD, '$.response.notarieelbetalendossierid') AS NOTARIEELBETALENDOSSIERID,
  JSON_VALUE(PAYLOAD, '$.response.notarieelbetalenaanmaakdatum') AS NOTARIEELBETALENAANMAAKDATUM,
  JSON_VALUE(PAYLOAD, '$.response.notarieelbetalenbetaalddatum') AS NOTARIEELBETALENBETAALDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.notarieelbetalenvrijgeefdatum') AS NOTARIEELBETALENVRIJGEEFDATUM,
  JSON_VALUE(PAYLOAD, '$.response.afleverenvoor') AS AFLEVERENVOOR,
  JSON_VALUE(PAYLOAD, '$.response.akdmemoverzenden') AS AKDMEMOVERZENDEN,
  JSON_VALUE(PAYLOAD, '$.response.notarieelbetalenbedrag') AS NOTARIEELBETALENBEDRAG,
  JSON_VALUE(PAYLOAD, '$.response.ordernummerfabrikant') AS ORDERNUMMERFABRIKANT,
  JSON_VALUE(PAYLOAD, '$.response.ottcode') AS OTTCODE,
  JSON_VALUE(PAYLOAD, '$.response.tenaamstelling1') AS TENAAMSTELLING1,
  JSON_VALUE(PAYLOAD, '$.response.tenaamstelling2') AS TENAAMSTELLING2,
  JSON_VALUE(PAYLOAD, '$.response.ponklantsoort') AS PONKLANTSOORT,
  JSON_VALUE(PAYLOAD, '$.response.foutmeldingbestelsysteem') AS FOUTMELDINGBESTELSYSTEEM,
  JSON_VALUE(PAYLOAD, '$.response.foutbijbestellen') AS FOUTBIJBESTELLEN,
  JSON_VALUE(PAYLOAD, '$.response.verzondennaarniivos') AS VERZONDENNAARNIIVOS,
  JSON_VALUE(PAYLOAD, '$.response.delytransactionid') AS DELYTRANSACTIONID,
  JSON_VALUE(PAYLOAD, '$.response.catalogid') AS CATALOGID,
  JSON_VALUE(PAYLOAD, '$.response.soortdoelstellingid') AS SOORTDOELSTELLINGID,
  JSON_VALUE(PAYLOAD, '$.response.besteljaar') AS BESTELJAAR,
  JSON_VALUE(PAYLOAD, '$.dtcmedia_crm_id') AS DTCMEDIA_CRM_ID

FROM
  ${ref("odbcDataProducer_lasttransaction")}
WHERE PUBLISHER = "SAMAfleveringPublisher"

`
let refs = pk.getRefs()
module.exports = {query, refs}
