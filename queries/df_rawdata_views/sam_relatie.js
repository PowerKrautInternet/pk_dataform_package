
/*config*/
let pk = require("../../sources")
let ref = pk.ref
let query = `
SELECT
JSON_VALUE(PAYLOAD, '$.dtcmedia_crm_id') AS RELATIE_DTCMEDIA_CRM_ID,
  JSON_VALUE(PAYLOAD, '$.type') AS RELATIE_TYPE,
  JSON_VALUE(PAYLOAD, '$.relatieid') AS RELATIE_RELATIEID,
  JSON_VALUE(PAYLOAD, '$.response.aanhefid') AS RELATIE_AANHEFID,
  JSON_VALUE(PAYLOAD, '$.response.aanmaakdatum') AS RELATIE_AANMAAKDATUM,
  JSON_VALUE(PAYLOAD, '$.response.aantalbedrautos') AS RELATIE_AANTALBEDRAUTOS,
  JSON_VALUE(PAYLOAD, '$.response.aantalkinderen') AS RELATIE_AANTALKINDEREN,
  JSON_VALUE(PAYLOAD, '$.response.aantalmedewerkers') AS RELATIE_AANTALMEDEWERKERS,
  JSON_VALUE(PAYLOAD, '$.response.aantalpersautos') AS RELATIE_AANTALPERSAUTOS,
  JSON_VALUE(PAYLOAD, '$.response.aantalzakelijkeautos') AS RELATIE_AANTALZAKELIJKEAUTOS,
  JSON_VALUE(PAYLOAD, '$.response.accountid') AS RELATIE_ACCOUNTID,
  JSON_VALUE(PAYLOAD, '$.response.accountmanagerid') AS RELATIE_ACCOUNTMANAGERID,
  JSON_VALUE(PAYLOAD, '$.response.accountrelatietype') AS RELATIE_ACCOUNTRELATIETYPE,
  JSON_VALUE(PAYLOAD, '$.response.achternaam') AS RELATIE_ACHTERNAAM,
  JSON_VALUE(PAYLOAD, '$.response.actief') AS RELATIE_ACTIEF,
  JSON_VALUE(PAYLOAD, '$.response.adpid') AS RELATIE_ADPID,
  JSON_VALUE(PAYLOAD, '$.response.afspraakbedrautos') AS RELATIE_AFSPRAAKBEDRAUTOS,
  JSON_VALUE(PAYLOAD, '$.response.afspraakpersautos') AS RELATIE_AFSPRAAKPERSAUTOS,
  JSON_VALUE(PAYLOAD, '$.response.autoomschrijving') AS RELATIE_AUTOOMSCHRIJVING,
  JSON_VALUE(PAYLOAD, '$.response.bedrautosklasseid') AS RELATIE_BEDRAUTOSKLASSEID,
  JSON_VALUE(PAYLOAD, '$.response.biccode') AS RELATIE_BICCODE,
  JSON_VALUE(PAYLOAD, '$.response.btwnr') AS RELATIE_BTWNR,
  JSON_VALUE(PAYLOAD, '$.response.cachedhasopeneinddatum') AS RELATIE_CACHEDHASOPENEINDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.cachedhasoptin') AS RELATIE_CACHEDHASOPTIN,
  JSON_VALUE(PAYLOAD, '$.response.datummutatie') AS RELATIE_DATUMMUTATIE,
  JSON_VALUE(PAYLOAD, '$.response.dealerid') AS RELATIE_DEALERID,
  JSON_VALUE(PAYLOAD, '$.response.directanoniem') AS RELATIE_DIRECTANONIEM,
  JSON_VALUE(PAYLOAD, '$.response.dmsid') AS RELATIE_DMSID,
  JSON_VALUE(PAYLOAD, '$.response.documentmap') AS RELATIE_DOCUMENTMAP,
  JSON_VALUE(PAYLOAD, '$.response.einddatum') AS RELATIE_EINDDATUM,
  JSON_VALUE(PAYLOAD, '$.response.einddatumberekend') AS RELATIE_EINDDATUMBEREKEND,
  JSON_VALUE(PAYLOAD, '$.response.email') AS RELATIE_EMAIL,
  JSON_VALUE(PAYLOAD, '$.response.emailcontact') AS RELATIE_EMAILCONTACT,
  JSON_VALUE(PAYLOAD, '$.response.emailoptin') AS RELATIE_EMAILOPTIN,
  JSON_VALUE(PAYLOAD, '$.response.emailzakelijk') AS RELATIE_EMAILZAKELIJK,
  JSON_VALUE(PAYLOAD, '$.response.emailzakelijkoptin') AS RELATIE_EMAILZAKELIJKOPTIN,
  JSON_VALUE(PAYLOAD, '$.response.externcode') AS RELATIE_EXTERNCODE,
  JSON_VALUE(PAYLOAD, '$.response.fax') AS RELATIE_FAX,
  JSON_VALUE(PAYLOAD, '$.response.fleetcode') AS RELATIE_FLEETCODE,
  JSON_VALUE(PAYLOAD, '$.response.formulierid') AS RELATIE_FORMULIERID,
  JSON_VALUE(PAYLOAD, '$.response.geboortedatum') AS RELATIE_GEBOORTEDATUM,
  JSON_VALUE(PAYLOAD, '$.response.geenfleetcode') AS RELATIE_GEENFLEETCODE,
  JSON_VALUE(PAYLOAD, '$.response.geenmobielnr') AS RELATIE_GEENMOBIELNR,
  JSON_VALUE(PAYLOAD, '$.response.geexporteerd') AS RELATIE_GEEXPORTEERD,
  JSON_VALUE(PAYLOAD, '$.response.geslacht') AS RELATIE_GESLACHT,
  JSON_VALUE(PAYLOAD, '$.response.heeftopenactie') AS RELATIE_HEEFTOPENACTIE,
  JSON_VALUE(PAYLOAD, '$.response.heeftopentraject') AS RELATIE_HEEFTOPENTRAJECT,
  JSON_VALUE(PAYLOAD, '$.response.herkomstid') AS RELATIE_HERKOMSTID,
  JSON_VALUE(PAYLOAD, '$.response.huidigewagenpark') AS RELATIE_HUIDIGEWAGENPARK,
  JSON_VALUE(PAYLOAD, '$.response.isanoniem') AS RELATIE_ISANONIEM,
  JSON_VALUE(PAYLOAD, '$.response.kenteken') AS RELATIE_KENTEKEN,
  JSON_VALUE(PAYLOAD, '$.response.klanttype') AS RELATIE_KLANTTYPE,
  JSON_VALUE(PAYLOAD, '$.response.kvknummer') AS RELATIE_KVKNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.kvkvestigingsnummer') AS RELATIE_KVKVESTIGINGSNUMMER,
  JSON_VALUE(PAYLOAD, '$.response.locale') AS RELATIE_LOCALE,
  JSON_VALUE(PAYLOAD, '$.response.medewerkersklasseid') AS RELATIE_MEDEWERKERSKLASSEID,
  JSON_VALUE(PAYLOAD, '$.response.nietbenaderen') AS RELATIE_NIETBENADEREN,
  JSON_VALUE(PAYLOAD, '$.response.ontdubbel') AS RELATIE_ONTDUBBEL,
  JSON_VALUE(PAYLOAD, '$.response.opmerking') AS RELATIE_OPMERKING,
  JSON_VALUE(PAYLOAD, '$.response.orgrtxid') AS RELATIE_ORGRTXID,
  JSON_VALUE(PAYLOAD, '$.response.overleden') AS RELATIE_OVERLEDEN,
  JSON_VALUE(PAYLOAD, '$.response.persautosklasseid') AS RELATIE_PERSAUTOSKLASSEID,
  JSON_VALUE(PAYLOAD, '$.response.postcontact') AS RELATIE_POSTCONTACT,
  JSON_VALUE(PAYLOAD, '$.response.probleem') AS RELATIE_PROBLEEM,
  JSON_VALUE(PAYLOAD, '$.response.rtxid') AS RELATIE_RTXID,
  JSON_VALUE(PAYLOAD, '$.response.soortbedrijfsactiviteitid') AS RELATIE_SOORTBEDRIJFSACTIVITEITID,
  JSON_VALUE(PAYLOAD, '$.response.soortbedrijfsvormid') AS RELATIE_SOORTBEDRIJFSVORMID,
  JSON_VALUE(PAYLOAD, '$.response.soortberoepid') AS RELATIE_SOORTBEROEPID,
  JSON_VALUE(PAYLOAD, '$.response.soortbrancheid') AS RELATIE_SOORTBRANCHEID,
  JSON_VALUE(PAYLOAD, '$.response.soortgezinssituatieid') AS RELATIE_SOORTGEZINSSITUATIEID,
  JSON_VALUE(PAYLOAD, '$.response.soorthobbyid') AS RELATIE_SOORTHOBBYID,
  JSON_VALUE(PAYLOAD, '$.response.soortrelatieid') AS RELATIE_SOORTRELATIEID,
  JSON_VALUE(PAYLOAD, '$.response.tel1') AS RELATIE_TEL1,
  JSON_VALUE(PAYLOAD, '$.response.tel1optin') AS RELATIE_TEL1OPTIN,
  JSON_VALUE(PAYLOAD, '$.response.tel1soortid') AS RELATIE_TEL1SOORTID,
  JSON_VALUE(PAYLOAD, '$.response.tel2') AS RELATIE_TEL2,
  JSON_VALUE(PAYLOAD, '$.response.tel2optin') AS RELATIE_TEL2OPTIN,
  JSON_VALUE(PAYLOAD, '$.response.tel2soortid') AS RELATIE_TEL2SOORTID,
  JSON_VALUE(PAYLOAD, '$.response.tel3') AS RELATIE_TEL3,
  JSON_VALUE(PAYLOAD, '$.response.tel3optin') AS RELATIE_TEL3OPTIN,
  JSON_VALUE(PAYLOAD, '$.response.tel3soortid') AS RELATIE_TEL3SOORTID,
  JSON_VALUE(PAYLOAD, '$.response.tel4') AS RELATIE_TEL4,
  JSON_VALUE(PAYLOAD, '$.response.tel4optin') AS RELATIE_TEL4OPTIN,
  JSON_VALUE(PAYLOAD, '$.response.tel4soortid') AS RELATIE_TEL4SOORTID,
  JSON_VALUE(PAYLOAD, '$.response.telefooncontact') AS RELATIE_TELEFOONCONTACT,
  JSON_VALUE(PAYLOAD, '$.response.tussenvoegsels') AS RELATIE_TUSSENVOEGSELS,
  JSON_VALUE(PAYLOAD, '$.response.url') AS RELATIE_URL,
  JSON_VALUE(PAYLOAD, '$.response.verkoperid') AS RELATIE_VERKOPERID,
  JSON_VALUE(PAYLOAD, '$.response.voorletters') AS RELATIE_VOORLETTERS,
  JSON_VALUE(PAYLOAD, '$.response.voornaam') AS RELATIE_VOORNAAM,
  JSON_VALUE(PAYLOAD, '$.response.zoekachternaam') AS RELATIE_ZOEKACHTERNAAM,
  JSON_VALUE(PAYLOAD, '$.response.zoekgeboortedag') AS RELATIE_ZOEKGEBOORTEDAG

FROM ${ref("odbcDataProducer_lasttransaction")}
      WHERE PUBLISHER = "SAMRelatiePublisher"


`
let refs = pk.getRefs()
module.exports = {query, refs}
